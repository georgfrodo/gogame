@using ShardTypes
@inject HttpClient Http
@inject IJSRuntime JSRuntime

<div class="container">
    @if (_bonusrunde)
    {
        <div class="emergency-light centered" style="display: flex; flex-direction: column;">
            <!-- Add your emergency light here. For example, you can use an image: -->
            <img src="images/emergencylight.gif" alt="Emergency Light"/>
            <div>
                <h1 style="color: white;">Bonusrunde!</h1>
            </div>
            <div>
                <h2 style="color: white;">Alle trinken</h2>
            </div>
        </div>
    }
    else if (!_gameOver)
    {
        <div class="card my-3">
            <div class="card-body">

                <p class="card-text text-center">
                    @_currentPlayer?.Name ist gerade dran!
                </p>
                <p class="card-text text-center">
                    @_currentPlayer?.Name hat @_currentPlayer?.NumberOfDrinksDone mal getrunken.
                </p>
                <p class="card-text text-center">Anzahl der Spieler: @GetPlayerNumber()</p>
                <div class="info-box">
                    @if (_currentPlayerEffects.Count > 0)
                    {
                        <h5 style="color: white">Effekte von @_currentPlayer?.Name</h5>

                        @foreach (var effect in _currentPlayerEffects)
                        {
                            <p class="effect-description">@effect.Description</p>
                        }
                    }
                </div>
            </div>
        </div>
        <div class="d-flex justify-content-center">
            <img class="img-fluid" style="max-height: 600px; max-width: 80%" src="@GetImagePath()"/>
        </div>

        @if (_myTurn)
        {
            <div class="d-flex justify-content-center my-3">
                @if (!_hasDrawn)
                {
                    <div>
                        <button class="btn btn-primary" style="margin: 5px" @onclick="DrawCard">Karte ziehen</button>
                    </div>
                }
                else
                {
                    <div>
                        <button class="btn btn-success" style="margin: 5px" @onclick="FinishTurn">Runde beenden</button>
                    </div>
                }
                <div>
                    <button class="btn btn-primary" style="margin: 5px" @onclick="PlayerDrank">Hab gsoffen</button>
                </div>
            </div>
        }

        <div class="effect-section" style="background-color:orangered; color: white; ">
            @foreach (var card in _myHand.Where(card => card.Type == CardType.Effect))
            {
                <p class="card-description">@card.Description</p>
            }
        </div>

        <div class="hand-section">
            @foreach (var card in _myHand.Where(card => card.Type == CardType.Trap))
            {
                <div class="card">
                    <img src="@($"images/cards/{card.ImageName}")" alt="@card.Name"/>
                    <div class="card-body">
                        <p class="card-text">@card.Description</p>
                    </div>
                    <button class="btn btn-primary" @onclick="@(() => PlayCard(card))">Karte spielen</button>
                </div>
            }
        </div>
    }
    else
    {
        <div class="d-flex justify-content-center">
            <img class="img-fluid" src="images/cards/end.png"/>
            <table class="table table-striped">
                <thead>
                <tr>
                    <th scope="col">Spieler</th>
                    <th scope="col">Wie oft gesoffen</th>
                </tr>
                </thead>
                <tbody>
                @if (Players != null)
                {
                    foreach (var player in Players)
                    {
                        <tr>
                            <td>@player.Name</td>
                            <td>@player.NumberOfDrinksDone</td>
                        </tr>
                    }
                }
                </tbody>
            </table>

        </div>
    }


</div>